# Maintainer: SuperBart <superbart_chen@qq.com>

pkgname=touhoudoom
pkgver=1
pkgrel=23
pkgdesc="A DOOM II Mod combines the blood of Doom and the cute girl of Touhou"
arch=('any')
url="https://github.com/UntitledsTakenNOOOO/TouhouDoom"
license=('custom')
depends=('gzdoom' 'freedoom')
makedepends=('zip' 'git')
optdepends=('doom2-data-steam: for better preformance')
source=("${pkgname}::git+${url}"
    ${pkgname}.desktop
    touhou-doom
    gzdoom-touhou.ini
)
md5sums=('SKIP'
  'fd88abfc7918bbd52b4f4e1aaa59eba0'
  '6982fa528dc0a69cdda8de4ee6d313f7'
  'c50cbdbd6fba0a6abb5cc9d5550e93e2')

prepare() {
  cd "${srcdir}/${pkgname}/pk3"
  git submodule update --init --recursive
  msg2 "making pk3 file..."
  zip -r ${pkgname}.pk3 * .[^.]*
  mv ${pkgname}.pk3 ../../${pkgname}.pk3
}

package() {
  install -Dm644 "${pkgname}.desktop" \
    "${pkgdir}/usr/share/applications/${pkgname}.desktop"
  install -Dm644 "${pkgname}.pk3" \
    "${pkgdir}/usr/share/games/doom/${pkgname}.pk3"
  install -m644 "gzdoom-touhou.ini" \
    "${pkgdir}/usr/share/games/doom/gzdoom-touhou.ini"
  install -Dm755 "touhou-doom" "$pkgdir/usr/bin/touhoudoom"
}


